<hr> <h3 id="1-install-qgis-server">1. Install QGIS Server</h3> <h4 id="--download-osgeo4w">- <a href="https://trac.osgeo.org/osgeo4w/" target="_blank" rel="noopener noreferrer">Download OSGeo4W</a> </h4> <h4 id="--run-osgeo4w-with-advanced-install-option">- Run OSGeo4W with Advanced Install option</h4> <p><img src="/assets/images/posts/2020/QGISServer/osgeo4w.png" alt="OSGeo4W"></p> <h4 id="--search-and-choose-qgis-server-to-install">- Search and choose qgis-server to install</h4> <p><img src="/assets/images/posts/2020/QGISServer/qgisserver.png" alt="QGIS Server"></p> <h4 id="--install-apache-as-web-server-for-qgis-server-download-the-xampp-installer-for-windows-and-install-apache">- Install Apache as Web Server for QGIS Server: Download the <a href="https://www.apachefriends.org/download.html" target="_blank" rel="noopener noreferrer">XAMPP installer</a> for Windows and install Apache</h4> <p><img src="/assets/images/posts/2020/QGISServer/apache.png" alt="Apache Install"></p> <h4 id="--configure-apache-to-run-qgis-server">- Configure Apache to run QGIS Server:</h4> <h5 id="--edit-the-httpdconf-file-cxamppapachehttpdconf--and-make-the-following-changes">- Edit the httpd.conf file (C:\xampp\apache\httpd.conf) and make the following changes:</h5> <p>From:<br> <code class="language-plaintext highlighter-rouge">ScriptAlias /cgi-bin/ "C:/xampp/cgi-bin/"</code><br> To:<br> <code class="language-plaintext highlighter-rouge">ScriptAlias /cgi-bin/ "c:/OSGeo4W64/apps/qgis/bin/"</code></p> <p>From:<br> <code class="language-plaintext highlighter-rouge">&lt;Directory "C:/xampp/cgi-bin"&gt; AllowOverride None Options None Require all granted &lt;/Directory&gt;</code> <br> To: <br> <code class="language-plaintext highlighter-rouge">&lt;Directory "c:/OSGeo4W64/apps/qgis/bin"&gt; SetHandler cgi-script AllowOverride None Options ExecCGI Order allow,deny Allow from all Require all granted &lt;/Directory&gt;</code></p> <p>From:<br> <code class="language-plaintext highlighter-rouge">AddHandler cgi-script .cgi .pl .asp</code><br> To:<br> <code class="language-plaintext highlighter-rouge">AddHandler cgi-script .cgi .pl .asp .exe</code></p> <h6 id="then-at-the-bottom-of-httpdconf-add">Then at the bottom of httpd.conf, add:</h6> <p><code class="language-plaintext highlighter-rouge">SetEnv GDAL_DATA "C:\OSGeo4W64\share\gdal" SetEnv QGIS_AUTH_DB_DIR_PATH "C:\OSGeo4W64\apps\qgis\resources" SetEnv PYTHONHOME "C:\OSGeo4W64\apps\Python37" SetEnv PATH "C:\OSGeo4W64\bin;C:\OSGeo4W64\apps\qgis\bin;C:\OSGeo4W64\apps\Qt5\bin;C:\WINDOWS\system32;C:\WINDOWS; C:\WINDOWS\System32\Wbem" SetEnv QGIS_PREFIX_PATH "C:\OSGeo4W64\apps\qgis" SetEnv QT_PLUGIN_PATH "C:\OSGeo4W64\apps\qgis\qtplugins;C:\OSGeo4W64\apps\Qt5\plugins"</code></p> <h5 id="--restart---apache-web-server-from-the-xampp-control-panel">- Restart Apache web server from the XAMPP Control Panel</h5> <p><img src="/assets/images/posts/2020/QGISServer/startapache.png" alt="Apache Restart"></p> <h5 id="--open-web-browser-to-testing-a-getcapabilities-request-to-qgis-server">- Open Web browser to testing a GetCapabilities request to QGIS Server:</h5> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetCapabilities</code><br> <img src="/assets/images/posts/2020/QGISServer/getcapabilities.png" alt="GetCapabilities"></p> <hr> <h3 id="2-publish-maps-to-qgis-server-from-a-qgis-project">2. Publish maps to QGIS Server from a QGIS Project</h3> <h4 id="--download-demo-data-unzip-the-files-in-the-qgis-server-tutorial-data">- Download <a href="https://github.com/qgis/QGIS-Training-Data/archive/v2.0.zip" target="_blank" rel="noopener noreferrer">demo data</a>, unzip the files in the qgis-server-tutorial-data</h4> <h4 id="--open-worldqgs-or-world3qgs-and-save-as-project-to-qgis-bin-folder-cosgeo4w64appsqgisbin">- Open world.qgs or (world3.qgs) and Save as Project to QGIS bin folder <code class="language-plaintext highlighter-rouge">(C:\OSGeo4W64\apps\qgis\bin)</code> </h4> <p><img src="/assets/images/posts/2020/QGISServer/qgisproject.png" alt="QGIS Project"></p> <h4 id="--there-are-4-layers-in-the-worldqgs-project">- There are 4 layers in the world.qgs project:</h4> <h6 id="airports">airports</h6> <h6 id="places">places</h6> <h6 id="countries">countries</h6> <h6 id="countries_shapeburst">countries_shapeburst</h6> <h4 id="--configure-wms-wmts-and-wfs-menu-project--properties--qgis-server">- Configure WMS, WMTS and WFS: menu Project –&gt; Properties –&gt; QGIS Server:</h4> <p><img src="/assets/images/posts/2020/QGISServer/configureqgisserver.png" alt="Configure QGIS Server"></p> <hr> <h3 id="3-test-qgis-server">3. Test QGIS Server:</h3> <h3 id="wms">WMS</h3> <h4 id="getcapabilities">GetCapabilities:</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetCapabilities&amp;map=world.qgs</code><br> <img src="/assets/images/posts/2020/QGISServer/getcapabilities2.png" alt="Get Capabilities of world map"></p> <h4 id="getporjectsetting">GetPorjectSetting</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?MAP=world.qgs&amp;SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetProjectSettings</code><br> <img src="/assets/images/posts/2020/QGISServer/getprojectsetting.png" alt="Get Project Setting"></p> <h4 id="getmap">GetMap</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?MAP=world.qgs&amp;SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetMap&amp;BBOX=10208324, 949379, 13572097, 2661355&amp;SRS=EPSG:3857&amp;WIDTH=665&amp;HEIGHT=551&amp;LAYERS=countries&amp;FORMAT=image/jpeg</code><br> <img src="/assets/images/posts/2020/QGISServer/getmap.png" alt="Get Map"></p> <h4 id="filter-and-opacity">Filter and Opacity</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?MAP=world.qgs&amp;SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetMap&amp;BBOX=-432786,4372992,3358959,7513746&amp;SRS=EPSG:3857&amp;WIDTH=665&amp;HEIGHT=551&amp;FORMAT=image/jpeg&amp;LAYERS=countries,countries_shapeburst&amp;STYLES=classified_by_name,blue&amp;OPACITIES=255,30&amp;FILTER=”countries:\”name\” IN ('Germany','Italy')”</code><br> <img src="/assets/images/posts/2020/QGISServer/filterandopacity.png" alt="Filter and Opacity"></p> <h4 id="use-redlining">Use Redlining</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?MAP=world.qgs&amp;SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetMap&amp;BBOX=-432786,4372992,3358959,7513746&amp;SRS=EPSG:3857&amp;WIDTH=665&amp;HEIGHT=551&amp;LAYERS=countries,countries_shapeburst&amp;FORMAT=image/jpeg&amp;HIGHLIGHT_GEOM=POLYGON((590000 6900000, 590000 7363000, 2500000 7363000, 2500000 6900000, 590000 6900000))&amp;HIGHLIGHT_SYMBOL=&lt;StyledLayerDescriptor&gt;&lt;UserStyle&gt;&lt;Name&gt;Highlight&lt;/Name&gt;&lt;FeatureTypeStyle&gt;&lt;Rule&gt;&lt;Name&gt;Symbol&lt;/Name&gt;&lt;LineSymbolizer&gt;&lt;Stroke&gt;&lt;SvgParameter ame="stroke"&gt;%233a093a&lt;/SvgParameter&gt;&lt;SvgParameter name="stroke-opacity"&gt;1&lt;/SvgParameter&gt;&lt;SvgParameter name="stroke-width"&gt;1.6&lt;/SvgParameter&gt;&lt;/Stroke&gt;&lt;/LineSymbolizer&gt;&lt;/Rule&gt;&lt;/FeatureTypeStyle&gt;&lt;/UserStyle&gt;&lt;/StyledLayerDescriptor&gt;&amp;HIGHLIGHT_LABELSTRING=QGIS Tutorial&amp;HIGHLIGHT_LABELSIZE=30&amp;HIGHLIGHT_LABELCOLOR=%23000000&amp;HIGHLIGHT_LABELBUFFERCOLOR=%23FFFFFF&amp;HIGHLIGHT_LABELBUFFERSIZE=3&amp;SELECTION=countries:171,65</code></p> <p><img src="/assets/images/posts/2020/QGISServer/redlining.png" alt="Use Redlining"></p> <h4 id="getprint">GetPrint</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?map=world.qgs&amp;SERVICE=WMS&amp;VERSION=1.3.0&amp;REQUEST=GetPrint&amp;FORMAT=pdf&amp;TRANSPARENT=true&amp;SRS=EPSG:3857&amp;DPI=300&amp;TEMPLATE=Population distribution&amp;map0:extent=-2786,4372992,3358959,7513746&amp;LAYERS=countries</code><br> <img src="/assets/images/posts/2020/QGISServer/getprint.png" alt="Get Print"></p> <h4 id="wfs-getfeature">WFS GetFeature</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?SERVICE=WFS&amp;VERSION=1.1.0&amp;REQUEST=GetFeature&amp;TYPENAME=countries&amp;map=world.qgs</code> <img src="/assets/images/posts/2020/QGISServer/wfsgetfeature.png" alt="WFS GetFeature"></p> <h4 id="wmts">WMTS:</h4> <p><code class="language-plaintext highlighter-rouge">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?SERVICE=WMTS&amp;REQUEST=GetTile&amp;MAP=world.qgs&amp;LAYER=countries&amp;FORMAT=image/png&amp;TILEMATRIXSET=EPSG:3857&amp;TileMatrix=0&amp;TILEROW=0&amp;TILECOL=0</code> <img src="/assets/images/posts/2020/QGISServer/wmts.png" alt="WMTS"></p> <h4 id="add-wfs-in-qgis-python-console">Add WFS in QGIS Python Console:</h4> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span> <span class="o">=</span> <span class="sh">'</span><span class="s">http://localhost/cgi-bin/qgis_mapserv.fcgi.exe?SERVICE=WFS&amp;VERSION=1.1.0&amp;REQUEST=GetFeature&amp;TYPENAME=countries&amp;map=world.qgs</span><span class="sh">'</span>
<span class="n">qgis</span><span class="p">.</span><span class="n">utils</span><span class="p">.</span><span class="n">iface</span><span class="p">.</span><span class="nf">addVectorLayer</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="sh">'</span><span class="s">qgisserverwfs</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">WFS</span><span class="sh">'</span><span class="p">)</span>  
</code></pre></div></div> <p><img src="/assets/images/posts/2020/QGISServer/wfsqgis.png" alt="Add WFS in QGIS Python Console"></p>